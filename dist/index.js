!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["redux-promise-queue-middleware"]=t():e["redux-promise-queue-middleware"]=t()}(this,function(){return function(e){function t(u){if(n[u])return n[u].exports;var c=n[u]={i:u,l:!1,exports:{}};return e[u].call(c.exports,c,c.exports,t),c.l=!0,c.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,u){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:u})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(module,__webpack_exports__,__webpack_require__){"use strict";eval("Object.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (immutable) */ __webpack_exports__[\"default\"] = promiseQueueMiddleware;\nfunction promiseQueueMiddleware() {\r\n    const queues = {};\r\n\r\n    return store => next => action => {\r\n        if (typeof action !== 'object' || typeof action['queue'] !== 'object' || typeof action['queue'].id !== 'string')\r\n            return next(action);\r\n\r\n        let queueInstance = action['queue'];\r\n\r\n        if (!queues[queueInstance.id])\r\n            queues[queueInstance.id] = dequeue(queueInstance, store, next, action);\r\n        else\r\n            queues[queueInstance.id] = queues[queueInstance.id].then((lastResult) => {\r\n                    return dequeue(queueInstance, store, next, action, lastResult);\r\n    });\r\n};\r\n}\r\n\r\nfunction dequeue(queueInstance, store, next, action, lastResult) {\r\n    if (typeof queueInstance.onActionDequeue === 'function')\r\n        queueInstance.onActionDequeue(action, lastResult, store);\r\n\r\n    return new Promise((resolve, reject) => {\r\n            let promise = queueInstance.promise ? queueInstance.promise : next(action);\r\n\r\n        if (promise instanceof Promise)\r\n            promise.then((lastResult) => {resolve(lastResult);});\r\n        else\r\n            resolve();\r\n    });\r\n}\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9pbmRleC5qcz85NTUyIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHByb21pc2VRdWV1ZU1pZGRsZXdhcmUoKSB7XHJcbiAgICBjb25zdCBxdWV1ZXMgPSB7fTtcclxuXHJcbiAgICByZXR1cm4gc3RvcmUgPT4gbmV4dCA9PiBhY3Rpb24gPT4ge1xyXG4gICAgICAgIGlmICh0eXBlb2YgYWN0aW9uICE9PSAnb2JqZWN0JyB8fCB0eXBlb2YgYWN0aW9uWydxdWV1ZSddICE9PSAnb2JqZWN0JyB8fCB0eXBlb2YgYWN0aW9uWydxdWV1ZSddLmlkICE9PSAnc3RyaW5nJylcclxuICAgICAgICAgICAgcmV0dXJuIG5leHQoYWN0aW9uKTtcclxuXHJcbiAgICAgICAgbGV0IHF1ZXVlSW5zdGFuY2UgPSBhY3Rpb25bJ3F1ZXVlJ107XHJcblxyXG4gICAgICAgIGlmICghcXVldWVzW3F1ZXVlSW5zdGFuY2UuaWRdKVxyXG4gICAgICAgICAgICBxdWV1ZXNbcXVldWVJbnN0YW5jZS5pZF0gPSBkZXF1ZXVlKHF1ZXVlSW5zdGFuY2UsIHN0b3JlLCBuZXh0LCBhY3Rpb24pO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcXVldWVzW3F1ZXVlSW5zdGFuY2UuaWRdID0gcXVldWVzW3F1ZXVlSW5zdGFuY2UuaWRdLnRoZW4oKGxhc3RSZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVxdWV1ZShxdWV1ZUluc3RhbmNlLCBzdG9yZSwgbmV4dCwgYWN0aW9uLCBsYXN0UmVzdWx0KTtcclxuICAgIH0pO1xyXG59O1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZXF1ZXVlKHF1ZXVlSW5zdGFuY2UsIHN0b3JlLCBuZXh0LCBhY3Rpb24sIGxhc3RSZXN1bHQpIHtcclxuICAgIGlmICh0eXBlb2YgcXVldWVJbnN0YW5jZS5vbkFjdGlvbkRlcXVldWUgPT09ICdmdW5jdGlvbicpXHJcbiAgICAgICAgcXVldWVJbnN0YW5jZS5vbkFjdGlvbkRlcXVldWUoYWN0aW9uLCBsYXN0UmVzdWx0LCBzdG9yZSk7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgbGV0IHByb21pc2UgPSBxdWV1ZUluc3RhbmNlLnByb21pc2UgPyBxdWV1ZUluc3RhbmNlLnByb21pc2UgOiBuZXh0KGFjdGlvbik7XHJcblxyXG4gICAgICAgIGlmIChwcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSlcclxuICAgICAgICAgICAgcHJvbWlzZS50aGVuKChsYXN0UmVzdWx0KSA9PiB7cmVzb2x2ZShsYXN0UmVzdWx0KTt9KTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgIH0pO1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==")}])});